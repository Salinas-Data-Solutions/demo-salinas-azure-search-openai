import{bF as J,bG as e,bH as Tt,bI as Re,bJ as Nt,bK as Lt,r as c,bL as Fe,bM as At,bN as It,bO as Pt,bP as Et,bQ as Mt,bR as Rt,bS as qt,bT as Bt,bU as Gt,bV as Ot,bW as Vt,bX as $t,bY as qe,bZ as Ft}from"./vendor-a721834a.js";import{D as Ue,S as y,I as _e,P as Ut,T as fe,a as Ht,B as be,b as Dt,c as Qt,M as zt,d as Kt,L as Wt,e as Jt,f as me,g as He,C as Xt,h as Be,i as Yt,j as Zt,k as es,l as Ge,m as ts,n as ss,o as ns,p as q,q as os,r as as,s as ge}from"./fluentui-react-fc377f87.js";import{e as rs,E as is,f as cs,g as ls,D as ds,h as us}from"./fluentui-icons-c444f2c4.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const r of d.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(o){if(o.ep)return;o.ep=!0;const d=n(o);fetch(o.href,d)}})();const hs=".auth/me",ms=".auth/refresh",gs=".auth/logout?post_logout_redirect_uri=/";async function ps(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const $=await ps(),P=$.useLogin,W=$.requireAccessControl,xs=$.msalConfig,_s=$.loginRequest,fs=$.tokenRequest,De=()=>window.location.origin+$.msalConfig.auth.redirectUri,Ss=()=>fetch(ms).then(t=>t.ok?fetch(hs).then(s=>s.ok?s.json().then(n=>n.length>0?{id_token:n[0].id_token,access_token:n[0].access_token,user_claims:n[0].user_claims.reduce((l,o)=>(l[o.typ]=o.val,l),{})}:null):null):null),B=await Ss(),ys=()=>{window.location.href=gs},Se=t=>t?.getActiveAccount()!=null||B!=null,ye=t=>B?Promise.resolve(B.access_token):t.acquireTokenSilent({...fs,redirectUri:De()}).then(s=>s.accessToken).catch(s=>{console.log(s)});const Cs="/assets/github-fab00c2d.svg",vs="_layout_1nrkm_1",bs="_header_1nrkm_7",js="_headerContainer_1nrkm_12",ws="_headerTitleContainer_1nrkm_20",ks="_headerLogo_1nrkm_28",Ts="_headerTitle_1nrkm_20",Ns="_headerNavList_1nrkm_37",Ls="_headerNavPageLink_1nrkm_43",As="_headerNavPageLinkActive_1nrkm_57",Is="_headerNavLeftMargin_1nrkm_62",Ps="_headerRightText_1nrkm_66",Es="_microsoftLogo_1nrkm_71",Ms="_githubLogo_1nrkm_76",b={layout:vs,header:bs,headerContainer:js,headerTitleContainer:ws,headerLogo:ks,headerTitle:Ts,headerNavList:Ns,headerNavPageLink:Ls,headerNavPageLinkActive:As,headerNavLeftMargin:Is,headerRightText:Ps,microsoftLogo:Es,githubLogo:Ms},Rs="_loginButton_m8yze_1",qs={loginButton:Rs},Bs=()=>{const{instance:t}=J(),s=t.getActiveAccount(),n=(s||B)!=null,l=()=>{t.loginPopup({..._s,redirectUri:De()}).catch(r=>console.log(r))},o=()=>{s?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(r=>console.log(r)):ys()},d=`Logout
${s?.username??B?.user_claims?.preferred_username}`;return e.jsx(Ue,{text:n?d:"Login",className:qs.loginButton,onClick:n?o:l})},Oe=()=>e.jsxs("div",{className:b.layout,children:[e.jsx("header",{className:b.header,role:"banner",children:e.jsxs("div",{className:b.headerContainer,children:[e.jsx(Tt,{to:"/",className:b.headerTitleContainer,children:e.jsx("h3",{className:b.headerTitle,children:"GPT + Enterprise data | Sample"})}),e.jsx("nav",{children:e.jsxs("ul",{className:b.headerNavList,children:[e.jsx("li",{children:e.jsx(Re,{to:"/",className:({isActive:t})=>t?b.headerNavPageLinkActive:b.headerNavPageLink,children:"Chat"})}),e.jsx("li",{className:b.headerNavLeftMargin,children:e.jsx(Re,{to:"/qa",className:({isActive:t})=>t?b.headerNavPageLinkActive:b.headerNavPageLink,children:"Ask a question"})}),e.jsx("li",{className:b.headerNavLeftMargin,children:e.jsx("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e.jsx("img",{src:Cs,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:b.githubLogo})})})]})}),e.jsx("h4",{className:b.headerRightText,children:"Azure OpenAI + AI Search"}),P&&e.jsx(Bs,{})]})}),e.jsx(Nt,{})]}),Gs="_container_ggo0d_1",Os="_chatRoot_ggo0d_8",Vs="_chatContainer_ggo0d_13",$s="_chatEmptyState_ggo0d_21",Fs="_chatEmptyStateTitle_ggo0d_31",Us="_chatEmptyStateSubtitle_ggo0d_38",Hs="_chatMessageStream_ggo0d_54",Ds="_chatMessageGpt_ggo0d_66",Qs="_chatMessageGptMinWidth_ggo0d_73",zs="_chatInput_ggo0d_78",Ks="_chatAnalysisPanel_ggo0d_91",Ws="_chatSettingsSeparator_ggo0d_99",Js="_loadingLogo_ggo0d_105",Xs="_commandsContainer_ggo0d_109",Ys="_commandButton_ggo0d_114",g={container:Gs,chatRoot:Os,chatContainer:Vs,chatEmptyState:$s,chatEmptyStateTitle:Fs,chatEmptyStateSubtitle:Us,chatMessageStream:Hs,chatMessageGpt:Ds,chatMessageGptMinWidth:Qs,chatInput:zs,chatAnalysisPanel:Ks,chatSettingsSeparator:Ws,loadingLogo:Js,commandsContainer:Xs,commandButton:Ys},ae="";function re(t){var s={"Content-Type":"application/json"};return P&&B==null&&t&&(s.Authorization=`Bearer ${t}`),s}async function yo(t,s){const n=await fetch(`${ae}/ask`,{method:"POST",headers:re(s),body:JSON.stringify(t)}),l=await n.json();if(n.status>299||!n.ok)throw Error(l.error||"Unknown error");return l}async function Zs(t){return await(await fetch(`${ae}/config`,{method:"GET",headers:re(t)})).json()}async function en(t,s){return await fetch(`${ae}/chat`,{method:"POST",headers:re(s),body:JSON.stringify(t)})}function Qe(t){return`${ae}/content/${t}`}var j=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(j||{}),I=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(I||{}),N=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(N||{});const tn="_answerContainer_1sqax_1",sn="_answerLogo_1sqax_11",nn="_answerText_1sqax_15",on="_selected_1sqax_34",an="_citationLearnMore_1sqax_38",rn="_citation_1sqax_38",cn="_followupQuestionsList_1sqax_60",ln="_followupQuestionLearnMore_1sqax_64",dn="_followupQuestion_1sqax_60",un="_supContainer_1sqax_83",hn="_retryButton_1sqax_112",mn="_loadingdots_1sqax_134",gn="_loading_1sqax_134",w={answerContainer:tn,answerLogo:sn,answerText:nn,selected:on,citationLearnMore:an,citation:rn,followupQuestionsList:cn,followupQuestionLearnMore:ln,followupQuestion:dn,supContainer:un,retryButton:hn,loadingdots:mn,loading:gn};function pn(t,s,n){const l=[];let o=t.trim();if(s){let u=o.length;for(let h=o.length-1;h>=0&&o[h]!=="]";h--)if(o[h]==="["){u=h;break}o=o.substring(0,u)}return{answerHtml:o.split(/\[([^\]]+)\]/g).map((u,p)=>{if(p%2===0)return u;{let h;l.indexOf(u)!==-1?h=l.indexOf(u)+1:(l.push(u),h=l.length);const m=Qe(u);return Lt(e.jsx("a",{className:"supContainer",title:u,onClick:()=>n(m),children:e.jsx("sup",{children:h})}))}}).join(""),citations:l}}const ze=()=>e.jsx(rs,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Ve=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:l,onThoughtProcessClicked:o,onSupportingContentClicked:d,onFollowupQuestionClicked:r,showFollowupQuestions:u})=>{const p=t.choices[0].context.followup_questions,h=t.choices[0].message.content,m=c.useMemo(()=>pn(h,n,l),[t]),x=Fe.sanitize(m.answerHtml);return e.jsxs(y,{className:`${w.answerContainer} ${s&&w.selected}`,verticalAlign:"space-between",children:[e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(ze,{}),e.jsxs("div",{children:[e.jsx(_e,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>o(),disabled:!t.choices[0].context.thoughts?.length}),e.jsx(_e,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>d(),disabled:!t.choices[0].context.data_points})]})]})}),e.jsx(y.Item,{grow:!0,children:e.jsx("div",{className:w.answerText,dangerouslySetInnerHTML:{__html:x}})}),!!m.citations.length&&e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:w.citationLearnMore,children:"Citations:"}),m.citations.map((_,v)=>{const C=Qe(_);return e.jsx("a",{className:w.citation,title:_,onClick:()=>l(C),children:`${++v}. ${_}`},v)})]})}),!!p?.length&&u&&r&&e.jsx(y.Item,{children:e.jsxs(y,{horizontal:!0,wrap:!0,className:`${m.citations.length?w.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:w.followupQuestionLearnMore,children:"Follow-up questions:"}),p.map((_,v)=>e.jsx("a",{className:w.followupQuestion,title:_,onClick:()=>r(_),children:`${_}`},v))]})})]})},xn=()=>{const t=At({from:{opacity:0},to:{opacity:1}});return e.jsx(It.div,{style:{...t},children:e.jsxs(y,{className:w.answerContainer,verticalAlign:"space-between",children:[e.jsx(ze,{}),e.jsx(y.Item,{grow:!0,children:e.jsxs("p",{className:w.answerText,children:["Generating answer",e.jsx("span",{className:w.loadingdots})]})})]})})},_n=({error:t,onRetry:s})=>e.jsxs(y,{className:w.answerContainer,verticalAlign:"space-between",children:[e.jsx(is,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(y.Item,{grow:!0,children:e.jsx("p",{className:w.answerText,children:t})}),e.jsx(Ut,{className:w.retryButton,onClick:s,text:"Retry"})]}),fn="_questionInputContainer_hiipw_1",Sn="_questionInputTextArea_hiipw_12",yn="_questionInputButtonsContainer_hiipw_17",pe={questionInputContainer:fn,questionInputTextArea:Sn,questionInputButtonsContainer:yn},Cn=({onSend:t,disabled:s,placeholder:n,clearOnSend:l,initQuestion:o})=>{const[d,r]=c.useState("");c.useEffect(()=>{o&&r(o)},[o]);const u=()=>{s||!d.trim()||(t(d),l&&r(""))},p=v=>{v.key==="Enter"&&!v.shiftKey&&(v.preventDefault(),u())},h=(v,C)=>{C?C.length<=1e3&&r(C):r("")},{instance:m}=J(),x=W&&!Se(m),_=s||!d.trim()||x;return x&&(n="Please login to continue..."),e.jsxs(y,{horizontal:!0,className:pe.questionInputContainer,children:[e.jsx(fe,{className:pe.questionInputTextArea,disabled:x,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:d,onChange:h,onKeyDown:p}),e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Ht,{content:"Ask question button",relationship:"label",children:e.jsx(be,{size:"large",icon:e.jsx(cs,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:_,onClick:u})})})]})},vn="_examplesNavList_o3hyg_1",bn="_example_o3hyg_1",jn="_exampleText_o3hyg_29",Ce={examplesNavList:vn,example:bn,exampleText:jn},wn=({text:t,value:s,onClick:n})=>e.jsx("div",{className:Ce.example,onClick:()=>n(s),children:e.jsx("p",{className:Ce.exampleText,children:t})}),kn=["What is included in my Northwind Health Plus plan that is not in standard?","What happens in a performance review?","What does a Product Manager do?"],Tn=["Compare the impact of interest rates and GDP in financial markets.","What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance","Can you identify any correlation between oil prices and stock market trends?"],Nn=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:Ce.examplesNavList,children:(s?Tn:kn).map((n,l)=>e.jsx("li",{children:e.jsx(wn,{text:n,value:n,onClick:t})},l))}),Ln="_container_1p3pb_1",An="_message_1p3pb_9",$e={container:Ln,message:An},oe=({message:t})=>e.jsx("div",{className:$e.container,children:e.jsx("div",{className:$e.message,children:t})}),In="_thoughtProcess_1ooqd_1",Pn="_tList_1ooqd_8",En="_tListItem_1ooqd_14",Mn="_tStep_1ooqd_40",Rn="_tCodeBlock_1ooqd_47",qn="_tProp_1ooqd_51",Bn="_citationImg_1ooqd_60",V={thoughtProcess:In,tList:Pn,tListItem:En,tStep:Mn,tCodeBlock:Rn,tProp:qn,citationImg:Bn};function Gn(t){const s=t.split(": "),n=s[0],l=Fe.sanitize(s.slice(1).join(": "));return{title:n,content:l}}const On="_supportingContentNavList_beb5d_1",Vn="_supportingContentItem_beb5d_9",$n="_supportingContentItemHeader_beb5d_23",Fn="_supportingContentItemText_beb5d_27",Un="_supportingContentItemImage_beb5d_32",K={supportingContentNavList:On,supportingContentItem:Vn,supportingContentItemHeader:$n,supportingContentItemText:Fn,supportingContentItemImage:Un},Hn=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:K.supportingContentNavList,children:[s.map((l,o)=>{const d=Gn(l);return e.jsxs("li",{className:K.supportingContentItem,children:[e.jsx("h4",{className:K.supportingContentItemHeader,children:d.title}),e.jsx("p",{className:K.supportingContentItemText,dangerouslySetInnerHTML:{__html:d.content}})]},o)}),n?.map((l,o)=>e.jsx("img",{className:K.supportingContentItemImage,src:l.url},o))]})};var L=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(L||{});const Dn=({thoughts:t})=>e.jsx("ul",{className:V.tList,children:t.map((s,n)=>e.jsxs("li",{className:V.tListItem,children:[e.jsx("div",{className:V.tStep,children:s.title}),e.jsx(y,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(l=>e.jsxs("span",{className:V.tProp,children:[l,": ",JSON.stringify(s.props?.[l])]}))}),Array.isArray(s.description)?e.jsx(Pt,{language:"json",wrapLongLines:!0,className:V.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},n))}),Qn="_downloadButton_1o536_1",zn="_markdownViewer_1o536_6",Kn="_loading_1o536_15",Wn="_error_1o536_21",Jn="_markdown_1o536_6",M={downloadButton:Qn,markdownViewer:zn,loading:Kn,error:Wn,markdown:Jn},Xn=({src:t})=>{const[s,n]=c.useState(""),[l,o]=c.useState(!0),[d,r]=c.useState(null),u=p=>{const h=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return p.replace(h,"")};return c.useEffect(()=>{(async()=>{try{const h=await fetch(t);if(!h.ok)throw new Error("Failed loading markdown file.");const m=await h.text(),x=await Et.parse(m),_=u(x);n(_)}catch(h){r(h)}finally{o(!1)}})()},[t]),e.jsx("div",{children:l?e.jsx("div",{className:`${M.loading} ${M.markdownViewer}`,children:e.jsx(Dt,{size:Qt.large,label:"Loading file"})}):d?e.jsx("div",{className:`${M.error} ${M.markdownViewer}`,children:e.jsxs(zt,{messageBarType:Kt.error,isMultiline:!1,children:[d.message,e.jsx(Wt,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(_e,{className:M.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${M.markdown} ${M.markdownViewer}`,dangerouslySetInnerHTML:{__html:s}})]})})},xe={disabled:!0,style:{color:"grey"}},Yn=({answer:t,activeTab:s,activeCitation:n,citationHeight:l,className:o,onActiveTabChanged:d})=>{const r=!t.choices[0].context.thoughts,u=!t.choices[0].context.data_points,p=!n,[h,m]=c.useState(""),x=P?J().instance:void 0,_=async()=>{const C=x?await ye(x):void 0;if(n){const F=n.indexOf("#")?n.split("#")[1]:"",ie=await(await fetch(n,{method:"GET",headers:re(C)})).blob();let U=URL.createObjectURL(ie);F&&(U+="#"+F),m(U)}};c.useEffect(()=>{_()},[]);const v=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:h,className:V.citationImg,alt:"Citation Image"});case"md":return e.jsx(Xn,{src:n});default:return e.jsx("iframe",{title:"Citation",src:h,width:"100%",height:l})}};return e.jsxs(Jt,{className:o,selectedKey:s,onLinkClick:C=>C&&d(C.props.itemKey),children:[e.jsx(me,{itemKey:L.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:r?xe:void 0,children:e.jsx(Dn,{thoughts:t.choices[0].context.thoughts||[]})}),e.jsx(me,{itemKey:L.SupportingContentTab,headerText:"Supporting content",headerButtonProps:u?xe:void 0,children:e.jsx(Hn,{supportingContent:t.choices[0].context.data_points})}),e.jsx(me,{itemKey:L.CitationTab,headerText:"Citation",headerButtonProps:p?xe:void 0,children:v()})]})},Zn="_container_cfwv2_1",eo={container:Zn},to=({className:t,onClick:s})=>e.jsx("div",{className:`${eo.container} ${t??""}`,children:e.jsx(be,{icon:e.jsx(ls,{}),onClick:s,children:"Developer settings"})}),so="_container_cfwv2_1",no={container:so},oo=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${no.container} ${t??""}`,children:e.jsx(be,{icon:e.jsx(ds,{}),disabled:s,onClick:n,children:"Clear chat"})}),ao="_container_1pzrp_1",ro={container:ao},io=[{key:N.Embedding,text:"Text Embeddings"},{key:N.ImageEmbedding,text:"Image Embeddings"},{key:N.Both,text:"Text and Image embeddings"}],co=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n})=>{const[l,o]=c.useState(j.Hybrid),[d,r]=c.useState(),u=(h,m)=>{o(m?.data||j.Hybrid),t(m?.data||j.Hybrid)},p=(h,m)=>{m&&r(m.key);let x;m?.key==="both"?x=[N.Embedding,N.ImageEmbedding]:x=[m?.key],s(x)};return c.useEffect(()=>{s(n?[N.Embedding,N.ImageEmbedding]:[N.Embedding])},[n]),e.jsxs(y,{className:ro.container,tokens:{childrenGap:10},children:[e.jsx(He,{label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:l==j.Hybrid,data:j.Hybrid},{key:"vectors",text:"Vectors",selected:l==j.Vectors,data:j.Vectors},{key:"text",text:"Text",selected:l==j.Text,data:j.Text}],required:!0,onChange:u}),n&&[j.Vectors,j.Hybrid].includes(l)&&e.jsx(Xt,{options:io,onChange:p,selectedKey:d,defaultSelectedKey:N.Both,label:"Vector Fields (Multi-query vector search)"})]})},lo=()=>{const{instance:t}=J(),s=t.getActiveAccount(),n=r=>typeof r=="string"?r:JSON.stringify(r),o=(r=>Object.keys(r??{}).map(u=>{let p=u;try{const m=new URL(u).pathname.split("/");u=m[m.length-1]}catch{}return{name:u,value:n((r??{})[p])}}))(s?.idTokenClaims??B?.user_claims),d=[Be({columnId:"name",compare:(r,u)=>r.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:r=>r.name}),Be({columnId:"value",compare:(r,u)=>r.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:r=>r.value})];return e.jsxs("div",{children:[e.jsx(Yt,{children:"ID Token Claims"}),e.jsxs(Zt,{items:o,columns:d,sortable:!0,getRowId:r=>r.name,children:[e.jsx(es,{children:e.jsx(Ge,{children:({renderHeaderCell:r})=>e.jsx(ts,{children:r()})})}),e.jsx(ss,{children:({item:r,rowId:u})=>e.jsx(Ge,{children:({renderCell:p})=>e.jsx(ns,{children:p(r)})},u)})]})]})},uo="_container_1pzrp_1",ho={container:uo},mo=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:l})=>{const[o,d]=c.useState(n),[r,u]=c.useState(l||I.TextAndImages),p=(m,x)=>{s(!!x),d(!!x)},h=(m,x)=>{if(x){const _=x.key;t(_||I.TextAndImages),_&&u(_)}};return c.useEffect(()=>{o&&t(I.TextAndImages)},[o]),e.jsxs(y,{className:ho.container,tokens:{childrenGap:10},children:[e.jsx(q,{checked:o,label:"Use GPT-4 Turbo with Vision",onChange:p}),o&&e.jsx(He,{selectedKey:r,label:"GPT-4 Turbo with Vision Inputs",options:[{key:I.TextAndImages,text:"Images and text from index"},{text:"Images only",key:I.Images},{text:"Text only",key:I.Texts}],required:!0,onChange:h})]})},go=()=>{const[t,s]=c.useState(!1),[n,l]=c.useState(""),[o,d]=c.useState(.3),[r,u]=c.useState(0),[p,h]=c.useState(0),[m,x]=c.useState(3),[_,v]=c.useState(j.Hybrid),[C,F]=c.useState(!0),[X,ie]=c.useState(!0),[U,Ke]=c.useState(!1),[je,We]=c.useState(""),[Y,Je]=c.useState(!1),[Xe,Ye]=c.useState([N.Embedding]),[we,Ze]=c.useState(!1),[ke,et]=c.useState(!1),[Te,tt]=c.useState(I.TextAndImages),[Z,st]=c.useState(!1),E=c.useRef(""),ce=c.useRef(null),[ee,te]=c.useState(!1),[Ne,le]=c.useState(!1),[se,de]=c.useState(),[Le,ue]=c.useState(),[H,G]=c.useState(void 0),[D,Ae]=c.useState(0),[k,ne]=c.useState([]),[Ie,Pe]=c.useState([]),[Ee,nt]=c.useState(!1),[ot,at]=c.useState(!1),[rt,it]=c.useState(!1),ct=async()=>{const i=O?await ye(O):void 0;Zs(i).then(a=>{nt(a.showGPT4VOptions),F(a.showSemanticRankerOption),at(a.showSemanticRankerOption),it(a.showVectorOption),a.showVectorOption||v(j.Text)})},lt=async(i,a,T,he)=>{let A="",f={};const jt=S=>new Promise(wt=>{setTimeout(()=>{A+=S;const kt={...f,choices:[{...f.choices[0],message:{content:A,role:f.choices[0].message.role}}]};Pe([...a,[i,kt]]),wt(null)},33)});try{le(!0);for await(const S of Mt(he))if(S.choices&&S.choices[0].context&&S.choices[0].context.data_points)S.choices[0].message=S.choices[0].delta,f=S;else if(S.choices&&S.choices[0].delta.content)te(!1),await jt(S.choices[0].delta.content);else if(S.choices&&S.choices[0].context)f.choices[0].context={...f.choices[0].context,...S.choices[0].context};else if(S.error)throw Error(S.error)}finally{le(!1)}return{...f,choices:[{...f.choices[0],message:{content:A,role:f.choices[0].message.role}}]}},O=P?J().instance:void 0,Q=async i=>{E.current=i,se&&de(void 0),te(!0),ue(void 0),G(void 0);const a=O?await ye(O):void 0;try{const he={messages:[...k.flatMap(f=>[{content:f[0],role:"user"},{content:f[1].choices[0].message.content,role:"assistant"}]),{content:i,role:"user"}],stream:X,context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:je.length===0?void 0:je,top:m,temperature:o,minimum_reranker_score:r,minimum_search_score:p,retrieval_mode:_,semantic_ranker:C,semantic_captions:U,suggest_followup_questions:Y,use_oid_security_filter:we,use_groups_security_filter:ke,vector_fields:Xe,use_gpt4v:Z,gpt4v_input:Te}},session_state:k.length?k[k.length-1][1].choices[0].session_state:null},A=await en(he,a);if(!A.body)throw Error("No response body");if(X){const f=await lt(i,k,ne,A.body);ne([...k,[i,f]])}else{const f=await A.json();if(A.status>299||!A.ok)throw Error(f.error||"Unknown error");ne([...k,[i,f]])}}catch(T){de(T)}finally{te(!1)}},dt=()=>{E.current="",se&&de(void 0),ue(void 0),G(void 0),ne([]),Pe([]),te(!1),le(!1)};c.useEffect(()=>ce.current?.scrollIntoView({behavior:"smooth"}),[ee]),c.useEffect(()=>ce.current?.scrollIntoView({behavior:"auto"}),[Ie]),c.useEffect(()=>{ct()},[]);const ut=(i,a)=>{l(a||"")},ht=(i,a,T)=>{d(i)},mt=(i,a)=>{h(parseFloat(a||"0"))},gt=(i,a)=>{u(parseFloat(a||"0"))},pt=(i,a)=>{x(parseInt(a||"3"))},xt=(i,a)=>{F(!!a)},_t=(i,a)=>{Ke(!!a)},ft=(i,a)=>{ie(!!a)},St=(i,a)=>{We(a||"")},yt=(i,a)=>{Je(!!a)},Ct=(i,a)=>{Ze(!!a)},vt=(i,a)=>{et(!!a)},bt=i=>{Q(i)},Me=(i,a)=>{Le===i&&H===L.CitationTab&&D===a?G(void 0):(ue(i),G(L.CitationTab)),Ae(a)},z=(i,a)=>{G(H===i&&D===a?void 0:i),Ae(a)};return e.jsxs("div",{className:g.container,children:[e.jsxs("div",{className:g.commandsContainer,children:[e.jsx(oo,{className:g.commandButton,onClick:dt,disabled:!E.current||ee}),e.jsx(to,{className:g.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:g.chatRoot,children:[e.jsxs("div",{className:g.chatContainer,children:[E.current?e.jsxs("div",{className:g.chatMessageStream,children:[Ne&&Ie.map((i,a)=>e.jsxs("div",{children:[e.jsx(oe,{message:i[0]}),e.jsx("div",{className:g.chatMessageGpt,children:e.jsx(Ve,{isStreaming:!0,answer:i[1],isSelected:!1,onCitationClicked:T=>Me(T,a),onThoughtProcessClicked:()=>z(L.ThoughtProcessTab,a),onSupportingContentClicked:()=>z(L.SupportingContentTab,a),onFollowupQuestionClicked:T=>Q(T),showFollowupQuestions:Y&&k.length-1===a},a)})]},a)),!Ne&&k.map((i,a)=>e.jsxs("div",{children:[e.jsx(oe,{message:i[0]}),e.jsx("div",{className:g.chatMessageGpt,children:e.jsx(Ve,{isStreaming:!1,answer:i[1],isSelected:D===a&&H!==void 0,onCitationClicked:T=>Me(T,a),onThoughtProcessClicked:()=>z(L.ThoughtProcessTab,a),onSupportingContentClicked:()=>z(L.SupportingContentTab,a),onFollowupQuestionClicked:T=>Q(T),showFollowupQuestions:Y&&k.length-1===a},a)})]},a)),ee&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{message:E.current}),e.jsx("div",{className:g.chatMessageGptMinWidth,children:e.jsx(xn,{})})]}),se?e.jsxs(e.Fragment,{children:[e.jsx(oe,{message:E.current}),e.jsx("div",{className:g.chatMessageGptMinWidth,children:e.jsx(_n,{error:se.toString(),onRetry:()=>Q(E.current)})})]}):null,e.jsx("div",{ref:ce})]}):e.jsxs("div",{className:g.chatEmptyState,children:[e.jsx(us,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:g.chatEmptyStateTitle,children:"Chat with your data"}),e.jsx("h2",{className:g.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(Nn,{onExampleClicked:bt,useGPT4V:Z})]}),e.jsx("div",{className:g.chatInput,children:e.jsx(Cn,{clearOnSend:!0,placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)",disabled:ee,onSend:i=>Q(i)})})]}),k.length>0&&H&&e.jsx(Yn,{className:g.chatAnalysisPanel,activeCitation:Le,onActiveTabChanged:i=>z(i,D),citationHeight:"810px",answer:k[D][1],activeTab:H}),e.jsxs(os,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(Ue,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(fe,{className:g.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:ut}),e.jsx(as,{className:g.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:o,onChange:ht,showValue:!0,snapToStep:!0}),e.jsx(ge,{className:g.chatSettingsSeparator,label:"Minimum search score",min:0,step:.01,defaultValue:p.toString(),onChange:mt}),e.jsx(ge,{className:g.chatSettingsSeparator,label:"Minimum reranker score",min:1,max:4,step:.1,defaultValue:r.toString(),onChange:gt}),e.jsx(ge,{className:g.chatSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:m.toString(),onChange:pt}),e.jsx(fe,{className:g.chatSettingsSeparator,label:"Exclude category",onChange:St}),ot&&e.jsx(q,{className:g.chatSettingsSeparator,checked:C,label:"Use semantic ranker for retrieval",onChange:xt}),e.jsx(q,{className:g.chatSettingsSeparator,checked:U,label:"Use query-contextual summaries instead of whole documents",onChange:_t,disabled:!C}),e.jsx(q,{className:g.chatSettingsSeparator,checked:Y,label:"Suggest follow-up questions",onChange:yt}),Ee&&e.jsx(mo,{gpt4vInputs:Te,isUseGPT4V:Z,updateUseGPT4V:i=>{st(i)},updateGPT4VInputs:i=>tt(i)}),rt&&e.jsx(co,{showImageOptions:Z&&Ee,updateVectorFields:i=>Ye(i),updateRetrievalMode:i=>v(i)}),P&&e.jsx(q,{className:g.chatSettingsSeparator,checked:we||W,label:"Use oid security filter",disabled:!Se(O)||W,onChange:Ct}),P&&e.jsx(q,{className:g.chatSettingsSeparator,checked:ke||W,label:"Use groups security filter",disabled:!Se(O)||W,onChange:vt}),e.jsx(q,{className:g.chatSettingsSeparator,checked:X,label:"Stream chat completion responses",onChange:ft}),P&&e.jsx(lo,{})]})]})]})};var ve;if(P){var R=new Rt(xs);!R.getActiveAccount()&&R.getAllAccounts().length>0&&R.setActiveAccount(R.getActiveAccount()),R.addEventCallback(t=>{if(t.eventType===qt.LOGIN_SUCCESS&&t.payload){const s=t.payload;R.setActiveAccount(s)}}),ve=e.jsx(Ft,{instance:R,children:e.jsx(Oe,{})})}else ve=e.jsx(Oe,{});Bt();const po=Gt([{path:"/",element:ve,children:[{index:!0,element:e.jsx(go,{})},{path:"qa",lazy:()=>qe(()=>import("./Ask-7a4567f6.js"),["assets/Ask-7a4567f6.js","assets/vendor-a721834a.js","assets/fluentui-react-fc377f87.js","assets/fluentui-icons-c444f2c4.js","assets/Ask-bd3d1290.css"])},{path:"*",lazy:()=>qe(()=>import("./NoPage-7efc85d3.js"),["assets/NoPage-7efc85d3.js","assets/vendor-a721834a.js"])}]}]);Ot.createRoot(document.getElementById("root")).render(e.jsx(Vt.StrictMode,{children:e.jsx($t,{router:po})}));export{Ve as A,Nn as E,I as G,Cn as Q,j as R,to as S,lo as T,N as V,L as a,_n as b,Yn as c,mo as d,co as e,Zs as f,ye as g,yo as h,Se as i,W as r,P as u};
//# sourceMappingURL=index-2cc97066.js.map
