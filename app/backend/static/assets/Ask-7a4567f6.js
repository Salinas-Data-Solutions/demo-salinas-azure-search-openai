import{r as s,bF as Ve,bG as t}from"./vendor-a721834a.js";import{R as q,G as Re,V as D,u as m,S as Ne,Q as Oe,E as Ge,A as Ie,a as S,b as Fe,c as Ue,d as Be,e as Ee,r as d,i as H,T as Me,g as z,f as Qe,h as Le}from"./index-2cc97066.js";import{b as qe,q as De,D as He,T as J,r as ze,s as f,p as g}from"./fluentui-react-fc377f87.js";import"./fluentui-icons-c444f2c4.js";const Je="_askContainer_1648b_1",Ke="_askTopSection_1648b_8",We="_askBottomSection_1648b_15",Xe="_askTitle_1648b_25",Ye="_askQuestionInput_1648b_39",Ze="_askAnswerContainer_1648b_46",$e="_askAnalysisPanel_1648b_53",et="_askSettingsSeparator_1648b_58",tt="_settingsButton_1648b_64",n={askContainer:Je,askTopSection:Ke,askBottomSection:We,askTitle:Xe,askQuestionInput:Ye,askAnswerContainer:Ze,askAnalysisPanel:$e,askSettingsSeparator:et,settingsButton:tt};function st(){const[b,h]=s.useState(!1),[k,K]=s.useState(""),[y,at]=s.useState(""),[j,nt]=s.useState(""),[A,W]=s.useState(.3),[P,X]=s.useState(0),[w,Y]=s.useState(0),[Z,V]=s.useState(q.Hybrid),[R,$]=s.useState(3),[C,N]=s.useState(!0),[O,ee]=s.useState(!1),[c,te]=s.useState(!1),[G,se]=s.useState(Re.TextAndImages),[I,ae]=s.useState(""),[ne,oe]=s.useState(""),[ie,re]=s.useState([D.Embedding,D.ImageEmbedding]),[F,ce]=s.useState(!1),[U,le]=s.useState(!1),[B,ue]=s.useState(!1),[pe,me]=s.useState(!1),[Se,de]=s.useState(!1),_=s.useRef(""),[x,E]=s.useState(!1),[l,M]=s.useState(),[o,ge]=s.useState(),[Q,L]=s.useState(),[u,r]=s.useState(void 0),i=m?Ve().instance:void 0,he=async()=>{const e=i?await z(i):void 0;Qe(e).then(a=>{ue(a.showGPT4VOptions),N(a.showSemanticRankerOption),me(a.showSemanticRankerOption),de(a.showVectorOption),a.showVectorOption||V(q.Text)})};s.useEffect(()=>{he()},[]);const v=async e=>{_.current=e,l&&M(void 0),E(!0),L(void 0),r(void 0);const a=i?await z(i):void 0;try{const p={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:k.length===0?void 0:k,prompt_template_prefix:y.length===0?void 0:y,prompt_template_suffix:j.length===0?void 0:j,exclude_category:I.length===0?void 0:I,top:R,temperature:A,minimum_reranker_score:P,minimum_search_score:w,retrieval_mode:Z,semantic_ranker:C,semantic_captions:O,use_oid_security_filter:F,use_groups_security_filter:U,vector_fields:ie,use_gpt4v:c,gpt4v_input:G}},session_state:o?o.choices[0].session_state:null},we=await Le(p,a);ge(we)}catch(p){M(p)}finally{E(!1)}},ke=(e,a)=>{K(a||"")},Ce=(e,a,p)=>{W(e)},_e=(e,a)=>{Y(parseFloat(a||"0"))},xe=(e,a)=>{X(parseFloat(a||"0"))},ve=(e,a)=>{$(parseInt(a||"3"))},Te=(e,a)=>{N(!!a)},fe=(e,a)=>{ee(!!a)},be=(e,a)=>{ae(a||"")},ye=e=>{v(e),oe(e)},je=e=>{Q===e&&u===S.CitationTab?r(void 0):(L(e),r(S.CitationTab))},T=e=>{r(u===e?void 0:e)},Ae=(e,a)=>{ce(!!a)},Pe=(e,a)=>{le(!!a)};return t.jsxs("div",{className:n.askContainer,children:[t.jsxs("div",{className:n.askTopSection,children:[t.jsx(Ne,{className:n.settingsButton,onClick:()=>h(!b)}),t.jsx("h1",{className:n.askTitle,children:"Ask your data"}),t.jsx("div",{className:n.askQuestionInput,children:t.jsx(Oe,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:x,initQuestion:ne,onSend:e=>v(e)})})]}),t.jsxs("div",{className:n.askBottomSection,children:[x&&t.jsx(qe,{label:"Generating answer"}),!_.current&&t.jsx(Ge,{onExampleClicked:ye,useGPT4V:c}),!x&&o&&!l&&t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(Ie,{answer:o,isStreaming:!1,onCitationClicked:e=>je(e),onThoughtProcessClicked:()=>T(S.ThoughtProcessTab),onSupportingContentClicked:()=>T(S.SupportingContentTab)})}),l?t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(Fe,{error:l.toString(),onRetry:()=>v(_.current)})}):null,u&&o&&t.jsx(Ue,{className:n.askAnalysisPanel,activeCitation:Q,onActiveTabChanged:e=>T(e),citationHeight:"600px",answer:o,activeTab:u})]}),t.jsxs(De,{headerText:"Configure answer generation",isOpen:b,isBlocking:!1,onDismiss:()=>h(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(He,{onClick:()=>h(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(J,{className:n.askSettingsSeparator,defaultValue:k,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:ke}),t.jsx(ze,{className:n.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:A,onChange:Ce,showValue:!0,snapToStep:!0}),t.jsx(f,{className:n.askSettingsSeparator,label:"Minimum search score",min:0,step:.01,defaultValue:w.toString(),onChange:_e}),t.jsx(f,{className:n.askSettingsSeparator,label:"Minimum reranker score",min:1,max:4,step:.1,defaultValue:P.toString(),onChange:xe}),t.jsx(f,{className:n.askSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:R.toString(),onChange:ve}),t.jsx(J,{className:n.askSettingsSeparator,label:"Exclude category",onChange:be}),pe&&t.jsx(g,{className:n.askSettingsSeparator,checked:C,label:"Use semantic ranker for retrieval",onChange:Te}),t.jsx(g,{className:n.askSettingsSeparator,checked:O,label:"Use query-contextual summaries instead of whole documents",onChange:fe,disabled:!C}),B&&t.jsx(Be,{gpt4vInputs:G,isUseGPT4V:c,updateUseGPT4V:e=>{te(e)},updateGPT4VInputs:e=>se(e)}),Se&&t.jsx(Ee,{showImageOptions:c&&B,updateVectorFields:e=>re(e),updateRetrievalMode:e=>V(e)}),m&&t.jsx(g,{className:n.askSettingsSeparator,checked:F||d,label:"Use oid security filter",disabled:!H(i)||d,onChange:Ae}),m&&t.jsx(g,{className:n.askSettingsSeparator,checked:U||d,label:"Use groups security filter",disabled:!H(i)||d,onChange:Pe}),m&&t.jsx(Me,{})]})]})}st.displayName="Ask";export{st as Component};
//# sourceMappingURL=Ask-7a4567f6.js.map
