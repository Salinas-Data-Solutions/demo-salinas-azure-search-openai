{"version":3,"file":"Ask-7a4567f6.js","sources":["../../../frontend/src/pages/ask/Ask.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport { Checkbox, Panel, DefaultButton, Spinner, Slider, TextField, SpinButton, IDropdownOption, Dropdown } from \"@fluentui/react\";\n\nimport styles from \"./Ask.module.css\";\n\nimport { askApi, configApi, ChatAppResponse, ChatAppRequest, RetrievalMode, VectorFieldOptions, GPT4VInput } from \"../../api\";\nimport { Answer, AnswerError } from \"../../components/Answer\";\nimport { QuestionInput } from \"../../components/QuestionInput\";\nimport { ExampleList } from \"../../components/Example\";\nimport { AnalysisPanel, AnalysisPanelTabs } from \"../../components/AnalysisPanel\";\nimport { SettingsButton } from \"../../components/SettingsButton/SettingsButton\";\nimport { useLogin, getToken, isLoggedIn, requireAccessControl } from \"../../authConfig\";\nimport { VectorSettings } from \"../../components/VectorSettings\";\nimport { GPT4VSettings } from \"../../components/GPT4VSettings\";\n\nimport { useMsal } from \"@azure/msal-react\";\nimport { TokenClaimsDisplay } from \"../../components/TokenClaimsDisplay\";\n\nexport function Component(): JSX.Element {\n    const [isConfigPanelOpen, setIsConfigPanelOpen] = useState(false);\n    const [promptTemplate, setPromptTemplate] = useState<string>(\"\");\n    const [promptTemplatePrefix, setPromptTemplatePrefix] = useState<string>(\"\");\n    const [promptTemplateSuffix, setPromptTemplateSuffix] = useState<string>(\"\");\n    const [temperature, setTemperature] = useState<number>(0.3);\n    const [minimumRerankerScore, setMinimumRerankerScore] = useState<number>(0);\n    const [minimumSearchScore, setMinimumSearchScore] = useState<number>(0);\n    const [retrievalMode, setRetrievalMode] = useState<RetrievalMode>(RetrievalMode.Hybrid);\n    const [retrieveCount, setRetrieveCount] = useState<number>(3);\n    const [useSemanticRanker, setUseSemanticRanker] = useState<boolean>(true);\n    const [useSemanticCaptions, setUseSemanticCaptions] = useState<boolean>(false);\n    const [useGPT4V, setUseGPT4V] = useState<boolean>(false);\n    const [gpt4vInput, setGPT4VInput] = useState<GPT4VInput>(GPT4VInput.TextAndImages);\n    const [excludeCategory, setExcludeCategory] = useState<string>(\"\");\n    const [question, setQuestion] = useState<string>(\"\");\n    const [vectorFieldList, setVectorFieldList] = useState<VectorFieldOptions[]>([VectorFieldOptions.Embedding, VectorFieldOptions.ImageEmbedding]);\n    const [useOidSecurityFilter, setUseOidSecurityFilter] = useState<boolean>(false);\n    const [useGroupsSecurityFilter, setUseGroupsSecurityFilter] = useState<boolean>(false);\n    const [showGPT4VOptions, setShowGPT4VOptions] = useState<boolean>(false);\n    const [showSemanticRankerOption, setShowSemanticRankerOption] = useState<boolean>(false);\n    const [showVectorOption, setShowVectorOption] = useState<boolean>(false);\n\n    const lastQuestionRef = useRef<string>(\"\");\n\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n    const [error, setError] = useState<unknown>();\n    const [answer, setAnswer] = useState<ChatAppResponse>();\n\n    const [activeCitation, setActiveCitation] = useState<string>();\n    const [activeAnalysisPanelTab, setActiveAnalysisPanelTab] = useState<AnalysisPanelTabs | undefined>(undefined);\n\n    const client = useLogin ? useMsal().instance : undefined;\n\n    const getConfig = async () => {\n        const token = client ? await getToken(client) : undefined;\n\n        configApi(token).then(config => {\n            setShowGPT4VOptions(config.showGPT4VOptions);\n            setUseSemanticRanker(config.showSemanticRankerOption);\n            setShowSemanticRankerOption(config.showSemanticRankerOption);\n            setShowVectorOption(config.showVectorOption);\n            if (!config.showVectorOption) {\n                setRetrievalMode(RetrievalMode.Text);\n            }\n        });\n    };\n\n    useEffect(() => {\n        getConfig();\n    }, []);\n\n    const makeApiRequest = async (question: string) => {\n        lastQuestionRef.current = question;\n\n        error && setError(undefined);\n        setIsLoading(true);\n        setActiveCitation(undefined);\n        setActiveAnalysisPanelTab(undefined);\n\n        const token = client ? await getToken(client) : undefined;\n\n        try {\n            const request: ChatAppRequest = {\n                messages: [\n                    {\n                        content: question,\n                        role: \"user\"\n                    }\n                ],\n                context: {\n                    overrides: {\n                        prompt_template: promptTemplate.length === 0 ? undefined : promptTemplate,\n                        prompt_template_prefix: promptTemplatePrefix.length === 0 ? undefined : promptTemplatePrefix,\n                        prompt_template_suffix: promptTemplateSuffix.length === 0 ? undefined : promptTemplateSuffix,\n                        exclude_category: excludeCategory.length === 0 ? undefined : excludeCategory,\n                        top: retrieveCount,\n                        temperature: temperature,\n                        minimum_reranker_score: minimumRerankerScore,\n                        minimum_search_score: minimumSearchScore,\n                        retrieval_mode: retrievalMode,\n                        semantic_ranker: useSemanticRanker,\n                        semantic_captions: useSemanticCaptions,\n                        use_oid_security_filter: useOidSecurityFilter,\n                        use_groups_security_filter: useGroupsSecurityFilter,\n                        vector_fields: vectorFieldList,\n                        use_gpt4v: useGPT4V,\n                        gpt4v_input: gpt4vInput\n                    }\n                },\n                // ChatAppProtocol: Client must pass on any session state received from the server\n                session_state: answer ? answer.choices[0].session_state : null\n            };\n            const result = await askApi(request, token);\n            setAnswer(result);\n        } catch (e) {\n            setError(e);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const onPromptTemplateChange = (_ev?: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\n        setPromptTemplate(newValue || \"\");\n    };\n\n    const onPromptTemplatePrefixChange = (_ev?: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\n        setPromptTemplatePrefix(newValue || \"\");\n    };\n\n    const onPromptTemplateSuffixChange = (_ev?: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, newValue?: string) => {\n        setPromptTemplateSuffix(newValue || \"\");\n    };\n\n    const onTemperatureChange = (\n        newValue: number,\n        range?: [number, number],\n        event?: React.MouseEvent | React.TouchEvent | MouseEvent | TouchEvent | React.KeyboardEvent\n    ) => {\n        setTemperature(newValue);\n    };\n\n    const onMinimumSearchScoreChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setMinimumSearchScore(parseFloat(newValue || \"0\"));\n    };\n\n    const onMinimumRerankerScoreChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setMinimumRerankerScore(parseFloat(newValue || \"0\"));\n    };\n    const onRetrieveCountChange = (_ev?: React.SyntheticEvent<HTMLElement, Event>, newValue?: string) => {\n        setRetrieveCount(parseInt(newValue || \"3\"));\n    };\n\n    const onRetrievalModeChange = (_ev: React.FormEvent<HTMLDivElement>, option?: IDropdownOption<RetrievalMode> | undefined, index?: number | undefined) => {\n        setRetrievalMode(option?.data || RetrievalMode.Hybrid);\n    };\n\n    const onUseSemanticRankerChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseSemanticRanker(!!checked);\n    };\n\n    const onUseSemanticCaptionsChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseSemanticCaptions(!!checked);\n    };\n\n    const onExcludeCategoryChanged = (_ev?: React.FormEvent, newValue?: string) => {\n        setExcludeCategory(newValue || \"\");\n    };\n\n    const onExampleClicked = (example: string) => {\n        makeApiRequest(example);\n        setQuestion(example);\n    };\n\n    const onShowCitation = (citation: string) => {\n        if (activeCitation === citation && activeAnalysisPanelTab === AnalysisPanelTabs.CitationTab) {\n            setActiveAnalysisPanelTab(undefined);\n        } else {\n            setActiveCitation(citation);\n            setActiveAnalysisPanelTab(AnalysisPanelTabs.CitationTab);\n        }\n    };\n\n    const onToggleTab = (tab: AnalysisPanelTabs) => {\n        if (activeAnalysisPanelTab === tab) {\n            setActiveAnalysisPanelTab(undefined);\n        } else {\n            setActiveAnalysisPanelTab(tab);\n        }\n    };\n\n    const onUseOidSecurityFilterChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseOidSecurityFilter(!!checked);\n    };\n\n    const onUseGroupsSecurityFilterChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, checked?: boolean) => {\n        setUseGroupsSecurityFilter(!!checked);\n    };\n\n    return (\n        <div className={styles.askContainer}>\n            <div className={styles.askTopSection}>\n                <SettingsButton className={styles.settingsButton} onClick={() => setIsConfigPanelOpen(!isConfigPanelOpen)} />\n                <h1 className={styles.askTitle}>Ask your data</h1>\n                <div className={styles.askQuestionInput}>\n                    <QuestionInput\n                        placeholder=\"Example: Does my plan cover annual eye exams?\"\n                        disabled={isLoading}\n                        initQuestion={question}\n                        onSend={question => makeApiRequest(question)}\n                    />\n                </div>\n            </div>\n            <div className={styles.askBottomSection}>\n                {isLoading && <Spinner label=\"Generating answer\" />}\n                {!lastQuestionRef.current && <ExampleList onExampleClicked={onExampleClicked} useGPT4V={useGPT4V} />}\n                {!isLoading && answer && !error && (\n                    <div className={styles.askAnswerContainer}>\n                        <Answer\n                            answer={answer}\n                            isStreaming={false}\n                            onCitationClicked={x => onShowCitation(x)}\n                            onThoughtProcessClicked={() => onToggleTab(AnalysisPanelTabs.ThoughtProcessTab)}\n                            onSupportingContentClicked={() => onToggleTab(AnalysisPanelTabs.SupportingContentTab)}\n                        />\n                    </div>\n                )}\n                {error ? (\n                    <div className={styles.askAnswerContainer}>\n                        <AnswerError error={error.toString()} onRetry={() => makeApiRequest(lastQuestionRef.current)} />\n                    </div>\n                ) : null}\n                {activeAnalysisPanelTab && answer && (\n                    <AnalysisPanel\n                        className={styles.askAnalysisPanel}\n                        activeCitation={activeCitation}\n                        onActiveTabChanged={x => onToggleTab(x)}\n                        citationHeight=\"600px\"\n                        answer={answer}\n                        activeTab={activeAnalysisPanelTab}\n                    />\n                )}\n            </div>\n\n            <Panel\n                headerText=\"Configure answer generation\"\n                isOpen={isConfigPanelOpen}\n                isBlocking={false}\n                onDismiss={() => setIsConfigPanelOpen(false)}\n                closeButtonAriaLabel=\"Close\"\n                onRenderFooterContent={() => <DefaultButton onClick={() => setIsConfigPanelOpen(false)}>Close</DefaultButton>}\n                isFooterAtBottom={true}\n            >\n                <TextField\n                    className={styles.askSettingsSeparator}\n                    defaultValue={promptTemplate}\n                    label=\"Override prompt template\"\n                    multiline\n                    autoAdjustHeight\n                    onChange={onPromptTemplateChange}\n                />\n\n                <Slider\n                    className={styles.chatSettingsSeparator}\n                    label=\"Temperature\"\n                    min={0}\n                    max={1}\n                    step={0.1}\n                    defaultValue={temperature}\n                    onChange={onTemperatureChange}\n                    showValue\n                    snapToStep\n                />\n\n                <SpinButton\n                    className={styles.askSettingsSeparator}\n                    label=\"Minimum search score\"\n                    min={0}\n                    step={0.01}\n                    defaultValue={minimumSearchScore.toString()}\n                    onChange={onMinimumSearchScoreChange}\n                />\n\n                <SpinButton\n                    className={styles.askSettingsSeparator}\n                    label=\"Minimum reranker score\"\n                    min={1}\n                    max={4}\n                    step={0.1}\n                    defaultValue={minimumRerankerScore.toString()}\n                    onChange={onMinimumRerankerScoreChange}\n                />\n\n                <SpinButton\n                    className={styles.askSettingsSeparator}\n                    label=\"Retrieve this many search results:\"\n                    min={1}\n                    max={50}\n                    defaultValue={retrieveCount.toString()}\n                    onChange={onRetrieveCountChange}\n                />\n                <TextField className={styles.askSettingsSeparator} label=\"Exclude category\" onChange={onExcludeCategoryChanged} />\n\n                {showSemanticRankerOption && (\n                    <Checkbox\n                        className={styles.askSettingsSeparator}\n                        checked={useSemanticRanker}\n                        label=\"Use semantic ranker for retrieval\"\n                        onChange={onUseSemanticRankerChange}\n                    />\n                )}\n\n                <Checkbox\n                    className={styles.askSettingsSeparator}\n                    checked={useSemanticCaptions}\n                    label=\"Use query-contextual summaries instead of whole documents\"\n                    onChange={onUseSemanticCaptionsChange}\n                    disabled={!useSemanticRanker}\n                />\n\n                {showGPT4VOptions && (\n                    <GPT4VSettings\n                        gpt4vInputs={gpt4vInput}\n                        isUseGPT4V={useGPT4V}\n                        updateUseGPT4V={useGPT4V => {\n                            setUseGPT4V(useGPT4V);\n                        }}\n                        updateGPT4VInputs={inputs => setGPT4VInput(inputs)}\n                    />\n                )}\n\n                {showVectorOption && (\n                    <VectorSettings\n                        showImageOptions={useGPT4V && showGPT4VOptions}\n                        updateVectorFields={(options: VectorFieldOptions[]) => setVectorFieldList(options)}\n                        updateRetrievalMode={(retrievalMode: RetrievalMode) => setRetrievalMode(retrievalMode)}\n                    />\n                )}\n\n                {useLogin && (\n                    <Checkbox\n                        className={styles.askSettingsSeparator}\n                        checked={useOidSecurityFilter || requireAccessControl}\n                        label=\"Use oid security filter\"\n                        disabled={!isLoggedIn(client) || requireAccessControl}\n                        onChange={onUseOidSecurityFilterChange}\n                    />\n                )}\n                {useLogin && (\n                    <Checkbox\n                        className={styles.askSettingsSeparator}\n                        checked={useGroupsSecurityFilter || requireAccessControl}\n                        label=\"Use groups security filter\"\n                        disabled={!isLoggedIn(client) || requireAccessControl}\n                        onChange={onUseGroupsSecurityFilterChange}\n                    />\n                )}\n                {useLogin && <TokenClaimsDisplay />}\n            </Panel>\n        </div>\n    );\n}\n\nComponent.displayName = \"Ask\";\n"],"names":["Component","isConfigPanelOpen","setIsConfigPanelOpen","useState","promptTemplate","setPromptTemplate","promptTemplatePrefix","setPromptTemplatePrefix","promptTemplateSuffix","setPromptTemplateSuffix","temperature","setTemperature","minimumRerankerScore","setMinimumRerankerScore","minimumSearchScore","setMinimumSearchScore","retrievalMode","setRetrievalMode","RetrievalMode","retrieveCount","setRetrieveCount","useSemanticRanker","setUseSemanticRanker","useSemanticCaptions","setUseSemanticCaptions","useGPT4V","setUseGPT4V","gpt4vInput","setGPT4VInput","GPT4VInput","excludeCategory","setExcludeCategory","question","setQuestion","vectorFieldList","setVectorFieldList","VectorFieldOptions","useOidSecurityFilter","setUseOidSecurityFilter","useGroupsSecurityFilter","setUseGroupsSecurityFilter","showGPT4VOptions","setShowGPT4VOptions","showSemanticRankerOption","setShowSemanticRankerOption","showVectorOption","setShowVectorOption","lastQuestionRef","useRef","isLoading","setIsLoading","error","setError","answer","setAnswer","activeCitation","setActiveCitation","activeAnalysisPanelTab","setActiveAnalysisPanelTab","client","useLogin","useMsal","getConfig","token","getToken","configApi","config","useEffect","makeApiRequest","request","result","askApi","e","onPromptTemplateChange","_ev","newValue","onTemperatureChange","range","event","onMinimumSearchScoreChange","onMinimumRerankerScoreChange","onRetrieveCountChange","onUseSemanticRankerChange","checked","onUseSemanticCaptionsChange","onExcludeCategoryChanged","onExampleClicked","example","onShowCitation","citation","AnalysisPanelTabs","onToggleTab","tab","onUseOidSecurityFilterChange","onUseGroupsSecurityFilterChange","jsxs","styles","jsx","SettingsButton","QuestionInput","Spinner","ExampleList","Answer","x","AnswerError","AnalysisPanel","Panel","DefaultButton","TextField","Slider","SpinButton","Checkbox","GPT4VSettings","inputs","VectorSettings","options","requireAccessControl","isLoggedIn","TokenClaimsDisplay"],"mappings":"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"}